root
 |-- key: binary (nullable = true)
 |-- value: binary (nullable = true)
 |-- topic: string (nullable = true)
 |-- partition: integer (nullable = true)
 |-- offset: long (nullable = true)
 |-- timestamp: timestamp (nullable = true)
 |-- timestampType: integer (nullable = true)
 |-- headers: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- key: string (nullable = true)
 |    |    |-- value: binary (nullable = true)

root
 |-- data: array (nullable = true)
 |    |-- element: struct (containsNull = true)
 |    |    |-- id: string (nullable = true)
 |    |    |-- value: string (nullable = true)
 |    |    |-- type: string (nullable = true)
 |    |    |-- timestamp: string (nullable = true)

root
 |-- elements: struct (nullable = true)
 |    |-- id: string (nullable = true)
 |    |-- value: string (nullable = true)
 |    |-- type: string (nullable = true)
 |    |-- timestamp: string (nullable = true)

root
 |-- ID: string (nullable = true)
 |-- Value: string (nullable = true)
 |-- Type: string (nullable = true)
 |-- Timestamp: string (nullable = true)

root
 |-- ID: string (nullable = true)
 |-- Value: integer (nullable = true)
 |-- Type: string (nullable = true)
 |-- Timestamp: string (nullable = true)
 |-- Millisecond: long (nullable = true)

-------------------------------------------
Batch: 15
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|845|  845| odd|2024-04-23 09:48:28|1713865708227|
|847|  847| odd|2024-04-23 09:48:38|1713865718239|
|849|  849| odd|2024-04-23 09:48:48|1713865728247|
|851|  851| odd|2024-04-23 09:48:58|1713865738255|
|853|  853| odd|2024-04-23 09:49:08|1713865748262|
|844|  844|even|2024-04-23 09:48:23|1713865703221|
|846|  846|even|2024-04-23 09:48:33|1713865713234|
|848|  848|even|2024-04-23 09:48:43|1713865723243|
|850|  850|even|2024-04-23 09:48:53|1713865733251|
|852|  852|even|2024-04-23 09:49:03|1713865743258|
|854|  854|even|2024-04-23 09:49:13|1713865753266|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 16
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|855|  855| odd|2024-04-23 09:49:18|1713865758270|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 17
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|856|  856|even|2024-04-23 09:49:23|1713865763274|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 18
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|857|  857| odd|2024-04-23 09:49:28|1713865768279|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 19
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|858|  858|even|2024-04-23 09:49:33|1713865773282|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 20
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|859|  859| odd|2024-04-23 09:49:38|1713865778286|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 21
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|860|  860|even|2024-04-23 09:49:43|1713865783292|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 22
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|861|  861| odd|2024-04-23 09:49:48|1713865788294|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 23
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|862|  862|even|2024-04-23 09:49:53|1713865793299|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 24
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|863|  863| odd|2024-04-23 09:49:58|1713865798306|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 25
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|864|  864|even|2024-04-23 09:50:03|1713865803311|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 26
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|865|  865| odd|2024-04-23 09:50:08|1713865808317|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 27
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|866|  866|even|2024-04-23 09:50:13|1713865813322|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 28
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|867|  867| odd|2024-04-23 09:50:18|1713865818327|
+---+-----+----+-------------------+-------------+

-------------------------------------------
Batch: 29
-------------------------------------------
+---+-----+----+-------------------+-------------+
| ID|Value|Type|          Timestamp|  Millisecond|
+---+-----+----+-------------------+-------------+
|868|  868|even|2024-04-23 09:50:23|1713865823335|
+---+-----+----+-------------------+-------------+

Traceback (most recent call last):
  File "/opt/spark-apps/spark-consumer.py", line 96, in <module>
    main()
  File "/opt/spark-apps/spark-consumer.py", line 93, in main
    out.awaitTermination()
  File "/opt/spark/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 103, in awaitTermination
  File "/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1303, in __call__
  File "/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1033, in send_command
  File "/opt/spark/python/lib/py4j-0.10.9-src.zip/py4j/java_gateway.py", line 1200, in send_command
  File "/usr/lib/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/opt/spark/python/lib/pyspark.zip/pyspark/context.py", line 281, in signal_handler
KeyboardInterrupt
